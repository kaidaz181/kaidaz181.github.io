<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lag Level Controller</title>
<style>
  html,body{height:100%;margin:0;font-family:monospace, "Courier New", monospace;background:#081017;color:#eaf5ff}
  .panel{max-width:720px;margin:48px auto;padding:20px;border-radius:10px;background:linear-gradient(180deg,#0f1417,#0b0f12);border:3px solid #0a0d10}
  h1{margin:0 0 14px;font-size:20px}
  .controller{display:flex;gap:16px;align-items:center;flex-wrap:wrap}
  .slider-wrap{flex:1;min-width:240px}
  input[type="range"]{width:100%}
  .value{min-width:100px;text-align:center;font-weight:700;font-size:18px}
  .buttons{margin-top:12px;display:flex;gap:8px}
  button{padding:8px 12px;border-radius:6px;border:0;background:#2f6fa6;color:white;font-weight:700;cursor:pointer}
  button.secondary{background:#6b6b6b}
  .note{margin-top:12px;color:#b8c4c9;font-size:13px}
</style>
</head>
<body>
  <div class="panel">
    <h1>Lag Level Controller</h1>

    <div class="controller">
      <div class="slider-wrap">
        <input id="slider" type="range" min="0" max="100" step="1" value="0" />
      </div>
      <div class="value" id="val">0</div>
    </div>

    <div class="buttons">
      <button id="setBtn">Set value</button>
      <button id="snap0" class="secondary">0 (no lag)</button>
      <button id="snap50" class="secondary">50</button>
      <button id="snap100" class="secondary">100 (max)</button>
    </div>

    <div class="note">Changes update Firebase in real time and will update all connected displays. Use this for testing.</div>
  </div>

<script type="module">
// ---------- FIREBASE CONFIG ----------
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDzQlAqhCeytCLEYafboYGpFu6pY3Kv9WE",
  authDomain: "allforonemedia-9a7d8.firebaseapp.com",
  projectId: "allforonemedia-9a7d8",
  storageBucket: "allforonemedia-9a7d8.firebasestorage.app",
  messagingSenderId: "892787060584",
  appId: "1:892787060584:web:54a7a9d300138b3596f0dd",
  measurementId: "G-X02R5ELKED",
  databaseURL: "https://allforonemedia-9a7d8-default-rtdb.firebaseio.com"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// ---------- DOM ----------
const slider = document.getElementById('slider');
const val = document.getElementById('val');
const setBtn = document.getElementById('setBtn');
const snap0 = document.getElementById('snap0');
const snap50 = document.getElementById('snap50');
const snap100 = document.getElementById('snap100');

function writeLagLevel(v){
  // ensure number 0..100
  const n = Math.max(0, Math.min(100, Math.round(Number(v) || 0)));
  set(ref(db, 'lag/level'), n).catch(err => {
    console.error('Write failed', err);
    alert('Failed to write to Firebase. Check database rules and network.');
  });
}

// update numeric label as slider moves (local preview)
slider.addEventListener('input', () => {
  val.textContent = slider.value;
});

// set button writes current slider value
setBtn.addEventListener('click', () => {
  writeLagLevel(slider.value);
});

// quick snaps
snap0.addEventListener('click', () => { slider.value = 0; val.textContent = 0; writeLagLevel(0); });
snap50.addEventListener('click', () => { slider.value = 50; val.textContent = 50; writeLagLevel(50); });
snap100.addEventListener('click', () => { slider.value = 100; val.textContent = 100; writeLagLevel(100); });

// optionally write as the slider moves (uncomment to enable)
// slider.addEventListener('change', () => writeLagLevel(slider.value));
// slider.addEventListener('mouseup', () => writeLagLevel(slider.value));
</script>
</body>
</html>
